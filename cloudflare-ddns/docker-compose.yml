# ==============================================================================
# AUTHOR:  aemcomtech.au
# VERSION: 1.2026.02.10.183440
# WEBSITE: aemcomtech.au
# PURPOSE: Automated Cloudflare DNS record synchronization
# ==============================================================================

services:
  cloudflare-ddns:
    image: oznu/cloudflare-ddns:latest
    container_name: cloudflare-ddns
    hostname: "cloudflare-ddns"
    labels:
      - "com.centurylinklabs.watchtower.enable=true"
    networks:
      - caddy_plex_default  # Standardized to your proxy network
    restart: unless-stopped
    healthcheck:
      test: ["CMD-SHELL", "pgrep -f 'node' || exit 1"]
      interval: 60s
      timeout: 10s
      retries: 10
      start_period: 20s
    env_file:
      - .env
    environment:
      - TZ=Australia/Melbourne
      - API_KEY=${CLOUDFLARE_API_TOKEN}
      - ZONE=aemcomtech.au
      - PROXIED=true  # Forces traffic through Cloudflare's proxy for security

networks:
  caddy_plex_default:
    external: true
    name: caddy_plex_default